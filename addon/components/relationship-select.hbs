<input
  class="hidden-input"
  value={{or (or @selected.id @selected.length) ""}}
  ...attributes
  {{did-insert (perform this.fetchModels)}}
/>
{{#let
  (component (if @multiple "power-select-multiple" "power-select"))
  as |RelationPowerSelect|
}}
  <RelationPowerSelect
    @searchEnabled={{this.searchEnabled}}
    @search={{perform this.fetchModels}}
    @options={{this.models}}
    @selected={{@selected}}
    @placeholder={{if
      this.fetchModels.isRunning
      (t "emeis.loading")
      @placeholder
    }}
    @noMatchesMessage={{t "emeis.empty"}}
    @renderInPlace={{true}}
    @allowClear={{true}}
    @onChange={{@onChange}}
    {{did-update (perform this.fetchModels) @model}}
    as |model|
  >
    {{yield model}}
  </RelationPowerSelect>
{{/let}}
